

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>imputegap.recovery.imputation &mdash; imputegap 0.1.6 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../static/custom.css" />

  
    <link rel="shortcut icon" href="https://www.naterscreations.com/imputegap/favicon.png"/>
      <script src="../../../static/jquery.js?v=5d32c60e"></script>
      <script src="../../../static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../static/documentation_options.js?v=6e0256f3"></script>
      <script src="../../../static/doctools.js?v=9bcbadda"></script>
      <script src="../../../static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            imputegap
              <img src="https://www.naterscreations.com/imputegap/logo_imputegab.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../autosummary/imputegap.recovery.manager.html">imputegap.recovery.manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autosummary/imputegap.recovery.imputation.html">imputegap.recovery.imputation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autosummary/imputegap.recovery.optimization.html">imputegap.recovery.optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autosummary/imputegap.recovery.explainer.html">imputegap.recovery.explainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autosummary/imputegap.recovery.evaluation.html">imputegap.recovery.evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autosummary/imputegap.algorithms.cdrec.html">imputegap.algorithms.cdrec</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autosummary/imputegap.algorithms.stmvl.html">imputegap.algorithms.stmvl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autosummary/imputegap.algorithms.iim.html">imputegap.algorithms.iim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autosummary/imputegap.algorithms.mrnn.html">imputegap.algorithms.mrnn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autosummary/imputegap.algorithms.min_impute.html">imputegap.algorithms.min_impute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autosummary/imputegap.algorithms.zero_impute.html">imputegap.algorithms.zero_impute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autosummary/imputegap.tools.utils.html">imputegap.tools.utils</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../imputegap.html">imputegap package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">imputegap</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">imputegap.recovery.imputation</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for imputegap.recovery.imputation</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">imputegap.recovery.evaluation</span> <span class="kn">import</span> <span class="n">Evaluation</span>
<span class="kn">from</span> <span class="nn">imputegap.algorithms.cdrec</span> <span class="kn">import</span> <span class="n">cdrec</span>
<span class="kn">from</span> <span class="nn">imputegap.algorithms.iim</span> <span class="kn">import</span> <span class="n">iim</span>
<span class="kn">from</span> <span class="nn">imputegap.algorithms.min_impute</span> <span class="kn">import</span> <span class="n">min_impute</span>
<span class="kn">from</span> <span class="nn">imputegap.algorithms.mrnn</span> <span class="kn">import</span> <span class="n">mrnn</span>
<span class="kn">from</span> <span class="nn">imputegap.algorithms.stmvl</span> <span class="kn">import</span> <span class="n">stmvl</span>
<span class="kn">from</span> <span class="nn">imputegap.algorithms.zero_impute</span> <span class="kn">import</span> <span class="n">zero_impute</span>
<span class="kn">from</span> <span class="nn">imputegap.tools</span> <span class="kn">import</span> <span class="n">utils</span>


<div class="viewcode-block" id="BaseImputer">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.BaseImputer">[docs]</a>
<span class="k">class</span> <span class="nc">BaseImputer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for imputation algorithms.</span>

<span class="sd">    This class provides common methods for imputation tasks such as scoring, parameter checking,</span>
<span class="sd">    and optimization. Specific algorithms should inherit from this class and implement the `impute` method.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    impute(params=None):</span>
<span class="sd">        Abstract method to perform the imputation.</span>
<span class="sd">    score(raw_matrix, imputed_matrix=None):</span>
<span class="sd">        Compute metrics for the imputed time series.</span>
<span class="sd">    _check_params(user_defined, params):</span>
<span class="sd">        Check and format parameters for imputation.</span>
<span class="sd">    _optimize(parameters={}):</span>
<span class="sd">        Optimize hyperparameters for the imputation algorithm.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">algorithm</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Class variable to hold the algorithm name</span>
    <span class="n">logs</span> <span class="o">=</span> <span class="kc">True</span>

<div class="viewcode-block" id="BaseImputer.__init__">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.BaseImputer.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infected_matrix</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the BaseImputer with an infected time series matrix.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        infected_matrix : numpy.ndarray</span>
<span class="sd">            Matrix used during the imputation of the time series.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">infected_matrix</span> <span class="o">=</span> <span class="n">infected_matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imputed_matrix</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="BaseImputer.impute">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.BaseImputer.impute">[docs]</a>
    <span class="k">def</span> <span class="nf">impute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Abstract method to perform the imputation. Must be implemented in subclasses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        params : dict, optional</span>
<span class="sd">            Dictionary of algorithm parameters (default is None).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        NotImplementedError</span>
<span class="sd">            If the method is not implemented by a subclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This method should be overridden by subclasses&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="BaseImputer.score">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.BaseImputer.score">[docs]</a>
    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_matrix</span><span class="p">,</span> <span class="n">imputed_matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute evaluation metrics for the imputed time series.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        raw_matrix : numpy.ndarray</span>
<span class="sd">            The original time series without contamination.</span>
<span class="sd">        imputed_matrix : numpy.ndarray, optional</span>
<span class="sd">            The imputed time series (default is None).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">imputed_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imputed_matrix</span> <span class="o">=</span> <span class="n">imputed_matrix</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="n">Evaluation</span><span class="p">(</span><span class="n">raw_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imputed_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">infected_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">metrics_computation</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">_check_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_defined</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Format the parameters for optimization or imputation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user_defined : bool</span>
<span class="sd">            Whether the parameters are user-defined or not.</span>
<span class="sd">        params : dict or list</span>
<span class="sd">            List or dictionary of parameters.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tuple</span>
<span class="sd">            Formatted parameters as a tuple.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">user_defined</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_optimize</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">params</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">params</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span> <span class="o">==</span> <span class="s2">&quot;iim&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">learning_neighbours</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">algo_code</span> <span class="o">=</span> <span class="s2">&quot;iim &quot;</span> <span class="o">+</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[\W_]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">learning_neighbours</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="p">(</span><span class="n">learning_neighbours</span><span class="p">,</span> <span class="n">algo_code</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span> <span class="o">==</span> <span class="s2">&quot;mrnn&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">,</span> <span class="n">iterations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span>
                    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">sequence_length</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">load_parameters</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;mrnn&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="p">(</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="n">sequence_length</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span>

    <span class="k">def</span> <span class="nf">_optimize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Conduct the optimization of the hyperparameters using different optimizers.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parameters : dict</span>
<span class="sd">            Dictionary containing optimization configurations such as ground_truth, optimizer, and options.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">imputegap.recovery.optimization</span> <span class="kn">import</span> <span class="n">Optimization</span>

        <span class="n">raw_data</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ground_truth&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">raw_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Need ground_truth to be able to adapt the hyper-parameters: </span><span class="si">{</span><span class="n">raw_data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">optimizer</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;optimizer&#39;</span><span class="p">,</span> <span class="s2">&quot;bayesian&quot;</span><span class="p">)</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">load_parameters</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="n">optimizer</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">optimizer&quot;</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="s2">&quot;has been called with&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">,</span> <span class="s2">&quot;...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">optimizer</span> <span class="o">==</span> <span class="s2">&quot;bayesian&quot;</span><span class="p">:</span>
            <span class="n">n_calls_d</span><span class="p">,</span> <span class="n">n_random_starts_d</span><span class="p">,</span> <span class="n">acq_func_d</span><span class="p">,</span> <span class="n">selected_metrics_d</span> <span class="o">=</span> <span class="n">defaults</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;options&#39;</span><span class="p">,</span> <span class="p">{})</span>

            <span class="n">n_calls</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;n_calls&#39;</span><span class="p">,</span> <span class="n">n_calls_d</span><span class="p">)</span>
            <span class="n">random_starts</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;n_random_starts&#39;</span><span class="p">,</span> <span class="n">n_random_starts_d</span><span class="p">)</span>
            <span class="n">func</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;acq_func&#39;</span><span class="p">,</span> <span class="n">acq_func_d</span><span class="p">)</span>
            <span class="n">metrics</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;selected_metrics&#39;</span><span class="p">,</span> <span class="n">selected_metrics_d</span><span class="p">)</span>

            <span class="n">bo_optimizer</span> <span class="o">=</span> <span class="n">Optimization</span><span class="o">.</span><span class="n">Bayesian</span><span class="p">()</span>

            <span class="n">optimal_params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">bo_optimizer</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">ground_truth</span><span class="o">=</span><span class="n">raw_data</span><span class="p">,</span>
                                                      <span class="n">contamination</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infected_matrix</span><span class="p">,</span>
                                                      <span class="n">selected_metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span>
                                                      <span class="n">algorithm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">,</span>
                                                      <span class="n">n_calls</span><span class="o">=</span><span class="n">n_calls</span><span class="p">,</span>
                                                      <span class="n">n_random_starts</span><span class="o">=</span><span class="n">random_starts</span><span class="p">,</span>
                                                      <span class="n">acq_func</span><span class="o">=</span><span class="n">func</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">optimizer</span> <span class="o">==</span> <span class="s2">&quot;pso&quot;</span><span class="p">:</span>

            <span class="n">n_particles_d</span><span class="p">,</span> <span class="n">c1_d</span><span class="p">,</span> <span class="n">c2_d</span><span class="p">,</span> <span class="n">w_d</span><span class="p">,</span> <span class="n">iterations_d</span><span class="p">,</span> <span class="n">n_processes_d</span><span class="p">,</span> <span class="n">selected_metrics_d</span> <span class="o">=</span> <span class="n">defaults</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;options&#39;</span><span class="p">,</span> <span class="p">{})</span>

            <span class="n">n_particles</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;n_particles&#39;</span><span class="p">,</span> <span class="n">n_particles_d</span><span class="p">)</span>
            <span class="n">c1</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="n">c1_d</span><span class="p">)</span>
            <span class="n">c2</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;c2&#39;</span><span class="p">,</span> <span class="n">c2_d</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">w_d</span><span class="p">)</span>
            <span class="n">iterations</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;iterations&#39;</span><span class="p">,</span> <span class="n">iterations_d</span><span class="p">)</span>
            <span class="n">n_processes</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;n_processes&#39;</span><span class="p">,</span> <span class="n">n_processes_d</span><span class="p">)</span>
            <span class="n">metrics</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;selected_metrics&#39;</span><span class="p">,</span> <span class="n">selected_metrics_d</span><span class="p">)</span>

            <span class="n">swarm_optimizer</span> <span class="o">=</span> <span class="n">Optimization</span><span class="o">.</span><span class="n">ParticleSwarm</span><span class="p">()</span>

            <span class="n">optimal_params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">swarm_optimizer</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">ground_truth</span><span class="o">=</span><span class="n">raw_data</span><span class="p">,</span>
                                                         <span class="n">contamination</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infected_matrix</span><span class="p">,</span>
                                                         <span class="n">selected_metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">,</span>
                                                         <span class="n">n_particles</span><span class="o">=</span><span class="n">n_particles</span><span class="p">,</span> <span class="n">c1</span><span class="o">=</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="o">=</span><span class="n">c2</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span>
                                                         <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">,</span> <span class="n">n_processes</span><span class="o">=</span><span class="n">n_processes</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">optimizer</span> <span class="o">==</span> <span class="s2">&quot;sh&quot;</span><span class="p">:</span>

            <span class="n">num_configs_d</span><span class="p">,</span> <span class="n">num_iterations_d</span><span class="p">,</span> <span class="n">reduction_factor_d</span><span class="p">,</span> <span class="n">selected_metrics_d</span> <span class="o">=</span> <span class="n">defaults</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;options&#39;</span><span class="p">,</span> <span class="p">{})</span>

            <span class="n">num_configs</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;num_configs&#39;</span><span class="p">,</span> <span class="n">num_configs_d</span><span class="p">)</span>
            <span class="n">num_iterations</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;num_iterations&#39;</span><span class="p">,</span> <span class="n">num_iterations_d</span><span class="p">)</span>
            <span class="n">reduction_factor</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reduction_factor&#39;</span><span class="p">,</span> <span class="n">reduction_factor_d</span><span class="p">)</span>
            <span class="n">metrics</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;selected_metrics&#39;</span><span class="p">,</span> <span class="n">selected_metrics_d</span><span class="p">)</span>

            <span class="n">sh_optimizer</span> <span class="o">=</span> <span class="n">Optimization</span><span class="o">.</span><span class="n">SuccessiveHalving</span><span class="p">()</span>

            <span class="n">optimal_params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sh_optimizer</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">ground_truth</span><span class="o">=</span><span class="n">raw_data</span><span class="p">,</span>
                                                      <span class="n">contamination</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infected_matrix</span><span class="p">,</span>
                                                      <span class="n">selected_metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">,</span>
                                                      <span class="n">num_configs</span><span class="o">=</span><span class="n">num_configs</span><span class="p">,</span> <span class="n">num_iterations</span><span class="o">=</span><span class="n">num_iterations</span><span class="p">,</span>
                                                      <span class="n">reduction_factor</span><span class="o">=</span><span class="n">reduction_factor</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_calls_d</span><span class="p">,</span> <span class="n">selected_metrics_d</span> <span class="o">=</span> <span class="n">defaults</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;options&#39;</span><span class="p">,</span> <span class="p">{})</span>

            <span class="n">n_calls</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;n_calls&#39;</span><span class="p">,</span> <span class="n">n_calls_d</span><span class="p">)</span>
            <span class="n">metrics</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;selected_metrics&#39;</span><span class="p">,</span> <span class="n">selected_metrics_d</span><span class="p">)</span>

            <span class="n">go_optimizer</span> <span class="o">=</span> <span class="n">Optimization</span><span class="o">.</span><span class="n">Greedy</span><span class="p">()</span>

            <span class="n">optimal_params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">go_optimizer</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">ground_truth</span><span class="o">=</span><span class="n">raw_data</span><span class="p">,</span>
                                                      <span class="n">contamination</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infected_matrix</span><span class="p">,</span>
                                                      <span class="n">selected_metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">,</span>
                                                      <span class="n">n_calls</span><span class="o">=</span><span class="n">n_calls</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">optimal_params</span></div>



<div class="viewcode-block" id="Imputation">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation">[docs]</a>
<span class="k">class</span> <span class="nc">Imputation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class containing static methods for evaluating and running imputation algorithms on time series data.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    evaluate_params(ground_truth, contamination, configuration, algorithm=&quot;cdrec&quot;):</span>
<span class="sd">        Evaluate imputation performance using given parameters and algorithm.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Imputation.evaluate_params">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.evaluate_params">[docs]</a>
    <span class="k">def</span> <span class="nf">evaluate_params</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">,</span> <span class="n">contamination</span><span class="p">,</span> <span class="n">configuration</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;cdrec&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluate various metrics for given parameters and imputation algorithm.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ground_truth : numpy.ndarray</span>
<span class="sd">            The original time series without contamination.</span>
<span class="sd">        contamination : numpy.ndarray</span>
<span class="sd">            The time series with contamination.</span>
<span class="sd">        configuration : tuple</span>
<span class="sd">            Tuple of the configuration of the algorithm.</span>
<span class="sd">        algorithm : str, optional</span>
<span class="sd">            Imputation algorithm to use. Valid values: &#39;cdrec&#39;, &#39;mrnn&#39;, &#39;stmvl&#39;, &#39;iim&#39; (default is &#39;cdrec&#39;).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            A dictionary of computed evaluation metrics.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">configuration</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">configuration</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">configuration</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="s1">&#39;cdrec&#39;</span><span class="p">:</span>
            <span class="n">rank</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">iterations</span> <span class="o">=</span> <span class="n">configuration</span>
            <span class="n">algo</span> <span class="o">=</span> <span class="n">Imputation</span><span class="o">.</span><span class="n">MD</span><span class="o">.</span><span class="n">CDRec</span><span class="p">(</span><span class="n">contamination</span><span class="p">)</span>
            <span class="n">algo</span><span class="o">.</span><span class="n">logs</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">algo</span><span class="o">.</span><span class="n">impute</span><span class="p">(</span><span class="n">user_defined</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;rank&quot;</span><span class="p">:</span> <span class="n">rank</span><span class="p">,</span> <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span> <span class="n">epsilon</span><span class="p">,</span> <span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="n">iterations</span><span class="p">})</span>

        <span class="k">elif</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="s1">&#39;iim&#39;</span><span class="p">:</span>
            <span class="n">learning_neighbours</span> <span class="o">=</span> <span class="n">configuration</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">alg_code</span> <span class="o">=</span> <span class="s2">&quot;iim &quot;</span> <span class="o">+</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[\W_]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">learning_neighbours</span><span class="p">))</span>

            <span class="n">algo</span> <span class="o">=</span> <span class="n">Imputation</span><span class="o">.</span><span class="n">Regression</span><span class="o">.</span><span class="n">IIM</span><span class="p">(</span><span class="n">contamination</span><span class="p">)</span>
            <span class="n">algo</span><span class="o">.</span><span class="n">logs</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">algo</span><span class="o">.</span><span class="n">impute</span><span class="p">(</span><span class="n">user_defined</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;learning_neighbours&quot;</span><span class="p">:</span> <span class="n">learning_neighbours</span><span class="p">,</span> <span class="s2">&quot;alg_code&quot;</span><span class="p">:</span> <span class="n">alg_code</span><span class="p">})</span>

        <span class="k">elif</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="s1">&#39;mrnn&#39;</span><span class="p">:</span>
            <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">,</span> <span class="n">iterations</span> <span class="o">=</span> <span class="n">configuration</span>

            <span class="n">algo</span> <span class="o">=</span> <span class="n">Imputation</span><span class="o">.</span><span class="n">ML</span><span class="o">.</span><span class="n">MRNN</span><span class="p">(</span><span class="n">contamination</span><span class="p">)</span>
            <span class="n">algo</span><span class="o">.</span><span class="n">logs</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">algo</span><span class="o">.</span><span class="n">impute</span><span class="p">(</span><span class="n">user_defined</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;hidden_dim&quot;</span><span class="p">:</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="n">learning_rate</span><span class="p">,</span> <span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="n">iterations</span><span class="p">,</span>
                                <span class="s2">&quot;seq_length&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">})</span>

        <span class="k">elif</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="s1">&#39;stmvl&#39;</span><span class="p">:</span>
            <span class="n">window_size</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">configuration</span>

            <span class="n">algo</span> <span class="o">=</span> <span class="n">Imputation</span><span class="o">.</span><span class="n">Pattern</span><span class="o">.</span><span class="n">STMVL</span><span class="p">(</span><span class="n">contamination</span><span class="p">)</span>
            <span class="n">algo</span><span class="o">.</span><span class="n">logs</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">algo</span><span class="o">.</span><span class="n">impute</span><span class="p">(</span><span class="n">user_defined</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;window_size&quot;</span><span class="p">:</span> <span class="n">window_size</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="n">gamma</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="n">alpha</span><span class="p">})</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid algorithm: </span><span class="si">{</span><span class="n">algorithm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">algo</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">)</span>
        <span class="n">imputation</span><span class="p">,</span> <span class="n">error_measures</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">imputed_matrix</span><span class="p">,</span> <span class="n">algo</span><span class="o">.</span><span class="n">metrics</span>

        <span class="k">return</span> <span class="n">error_measures</span></div>


<div class="viewcode-block" id="Imputation.Stats">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.Stats">[docs]</a>
    <span class="k">class</span> <span class="nc">Stats</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A class containing specific imputation algorithms for statistical methods.</span>

<span class="sd">        Subclasses</span>
<span class="sd">        ----------</span>
<span class="sd">        ZeroImpute :</span>
<span class="sd">            Imputation method that replaces missing values with zeros.</span>
<span class="sd">        MinImpute :</span>
<span class="sd">            Imputation method that replaces missing values with the minimum value of the ground truth.</span>
<span class="sd">        &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Imputation.Stats.ZeroImpute">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.Stats.ZeroImpute">[docs]</a>
        <span class="k">class</span> <span class="nc">ZeroImpute</span><span class="p">(</span><span class="n">BaseImputer</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            ZeroImpute class to impute missing values with zeros.</span>

<span class="sd">            Methods</span>
<span class="sd">            -------</span>
<span class="sd">            impute(self, params=None):</span>
<span class="sd">                Perform imputation by replacing missing values with zeros.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">algorithm</span> <span class="o">=</span> <span class="s2">&quot;zero_impute&quot;</span>

<div class="viewcode-block" id="Imputation.Stats.ZeroImpute.impute">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.Stats.ZeroImpute.impute">[docs]</a>
            <span class="k">def</span> <span class="nf">impute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Impute missing values by replacing them with zeros.</span>
<span class="sd">                Template for adding external new algorithm</span>

<span class="sd">                Parameters</span>
<span class="sd">                ----------</span>
<span class="sd">                params : dict, optional</span>
<span class="sd">                    Dictionary of algorithm parameters (default is None).</span>

<span class="sd">                Returns</span>
<span class="sd">                -------</span>
<span class="sd">                self : ZeroImpute</span>
<span class="sd">                    The object with `imputed_matrix` set.</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">imputed_matrix</span> <span class="o">=</span> <span class="n">zero_impute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">infected_matrix</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

                <span class="k">return</span> <span class="bp">self</span></div>
</div>


<div class="viewcode-block" id="Imputation.Stats.MinImpute">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.Stats.MinImpute">[docs]</a>
        <span class="k">class</span> <span class="nc">MinImpute</span><span class="p">(</span><span class="n">BaseImputer</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            MinImpute class to impute missing values with the minimum value of the ground truth.</span>

<span class="sd">            Methods</span>
<span class="sd">            -------</span>
<span class="sd">            impute(self, params=None):</span>
<span class="sd">                Perform imputation by replacing missing values with the minimum value of the ground truth.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">algorithm</span> <span class="o">=</span> <span class="s2">&quot;min_impute&quot;</span>

<div class="viewcode-block" id="Imputation.Stats.MinImpute.impute">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.Stats.MinImpute.impute">[docs]</a>
            <span class="k">def</span> <span class="nf">impute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Impute missing values by replacing them with the minimum value of the ground truth.</span>
<span class="sd">                Template for adding external new algorithm</span>

<span class="sd">                Parameters</span>
<span class="sd">                ----------</span>
<span class="sd">                params : dict, optional</span>
<span class="sd">                    Dictionary of algorithm parameters (default is None).</span>

<span class="sd">                Returns</span>
<span class="sd">                -------</span>
<span class="sd">                self : MinImpute</span>
<span class="sd">                    The object with `imputed_matrix` set.</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">imputed_matrix</span> <span class="o">=</span> <span class="n">min_impute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">infected_matrix</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

                <span class="k">return</span> <span class="bp">self</span></div>
</div>
</div>


<div class="viewcode-block" id="Imputation.MD">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.MD">[docs]</a>
    <span class="k">class</span> <span class="nc">MD</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A class containing imputation algorithms for matrix decomposition methods.</span>

<span class="sd">        Subclasses</span>
<span class="sd">        ----------</span>
<span class="sd">        CDRec :</span>
<span class="sd">            Imputation method using Centroid Decomposition.</span>
<span class="sd">        &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Imputation.MD.CDRec">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.MD.CDRec">[docs]</a>
        <span class="k">class</span> <span class="nc">CDRec</span><span class="p">(</span><span class="n">BaseImputer</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            CDRec class to impute missing values using Centroid Decomposition (CDRec).</span>

<span class="sd">            Methods</span>
<span class="sd">            -------</span>
<span class="sd">            impute(self, user_defined=True, params=None):</span>
<span class="sd">                Perform imputation using the CDRec algorithm.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">algorithm</span> <span class="o">=</span> <span class="s2">&quot;cdrec&quot;</span>

<div class="viewcode-block" id="Imputation.MD.CDRec.impute">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.MD.CDRec.impute">[docs]</a>
            <span class="k">def</span> <span class="nf">impute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_defined</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Perform imputation using the CDRec algorithm.</span>

<span class="sd">                Parameters</span>
<span class="sd">                ----------</span>
<span class="sd">                user_defined : bool, optional</span>
<span class="sd">                    Whether to use user-defined or default parameters (default is True).</span>
<span class="sd">                params : dict, optional</span>
<span class="sd">                    Parameters of the CDRec algorithm or Auto-ML configuration, if None, default ones are loaded.</span>

<span class="sd">                    **Algorithm parameters:**</span>

<span class="sd">                    - rank : int</span>
<span class="sd">                        Rank of matrix reduction, which should be higher than 1 and smaller than the number of series.</span>
<span class="sd">                    - epsilon : float</span>
<span class="sd">                        The learning rate used for the algorithm.</span>
<span class="sd">                    - iterations : int</span>
<span class="sd">                        The number of iterations to perform.</span>

<span class="sd">                    **Auto-ML parameters:**</span>

<span class="sd">                    - ground_truth : numpy.ndarray</span>
<span class="sd">                        The original time series dataset without contamination.</span>
<span class="sd">                    - optimizer : str</span>
<span class="sd">                        The optimizer to use for parameter optimization. Valid values are &quot;bayesian&quot;, &quot;greedy&quot;, &quot;pso&quot;, or &quot;sh&quot;.</span>
<span class="sd">                    - options : dict, optional</span>
<span class="sd">                        Optional parameters specific to the optimizer.</span>

<span class="sd">                        **Bayesian:**</span>

<span class="sd">                        - n_calls : int, optional</span>
<span class="sd">                            Number of calls to the objective function. Default is 3.</span>
<span class="sd">                        - selected_metrics : list, optional</span>
<span class="sd">                            List of selected metrics to consider for optimization. Default is [&quot;RMSE&quot;].</span>
<span class="sd">                        - n_random_starts : int, optional</span>
<span class="sd">                            Number of initial calls to the objective function, from random points. Default is 50.</span>
<span class="sd">                        - acq_func : str, optional</span>
<span class="sd">                            Acquisition function to minimize over the Gaussian prior. Valid values: &#39;LCB&#39;, &#39;EI&#39;, &#39;PI&#39;, &#39;gp_hedge&#39; (default is &#39;gp_hedge&#39;).</span>

<span class="sd">                        **Greedy:**</span>

<span class="sd">                        - n_calls : int, optional</span>
<span class="sd">                            Number of calls to the objective function. Default is 3.</span>
<span class="sd">                        - selected_metrics : list, optional</span>
<span class="sd">                            List of selected metrics to consider for optimization. Default is [&quot;RMSE&quot;].</span>

<span class="sd">                        **PSO:**</span>

<span class="sd">                        - n_particles : int, optional</span>
<span class="sd">                            Number of particles used.</span>
<span class="sd">                        - c1 : float, optional</span>
<span class="sd">                            PSO learning coefficient c1 (personal learning).</span>
<span class="sd">                        - c2 : float, optional</span>
<span class="sd">                            PSO learning coefficient c2 (global learning).</span>
<span class="sd">                        - w : float, optional</span>
<span class="sd">                            PSO inertia weight.</span>
<span class="sd">                        - iterations : int, optional</span>
<span class="sd">                            Number of iterations for the optimization.</span>
<span class="sd">                        - n_processes : int, optional</span>
<span class="sd">                            Number of processes during optimization.</span>

<span class="sd">                        **Successive Halving (SH):**</span>

<span class="sd">                        - num_configs : int, optional</span>
<span class="sd">                            Number of configurations to try.</span>
<span class="sd">                        - num_iterations : int, optional</span>
<span class="sd">                            Number of iterations to run the optimization.</span>
<span class="sd">                        - reduction_factor : int, optional</span>
<span class="sd">                            Reduction factor for the number of configurations kept after each iteration.</span>

<span class="sd">                Returns</span>
<span class="sd">                -------</span>
<span class="sd">                self : CDRec</span>
<span class="sd">                    CDRec object with `imputed_matrix` set.</span>

<span class="sd">                Example</span>
<span class="sd">                -------</span>
<span class="sd">                &gt;&gt;&gt; cdrec_imputer = Imputation.MD.CDRec(infected_matrix)</span>
<span class="sd">                &gt;&gt;&gt; cdrec_imputer.impute()  # default parameters for imputation &gt; or</span>
<span class="sd">                &gt;&gt;&gt; cdrec_imputer.impute(user_defined=True, params={&#39;rank&#39;: 5, &#39;epsilon&#39;: 0.01, &#39;iterations&#39;: 100})  # user-defined &gt; or</span>
<span class="sd">                &gt;&gt;&gt; cdrec_imputer.impute(user_defined=False, params={&quot;ground_truth&quot;: ts_1.data, &quot;optimizer&quot;: &quot;bayesian&quot;, &quot;options&quot;: {&quot;n_calls&quot;: 2}})  # auto-ml with bayesian</span>
<span class="sd">                &gt;&gt;&gt; imputed_data = cdrec_imputer.imputed_matrix</span>

<span class="sd">                References</span>
<span class="sd">                ----------</span>
<span class="sd">                Khayati, M., Cudr-Mauroux, P. &amp; Bhlen, M.H. Scalable recovery of missing blocks in time series with high and low cross-correlations. Knowl Inf Syst 62, 22572280 (2020). https://doi.org/10.1007/s10115-019-01421-7</span>
<span class="sd">                &quot;&quot;&quot;</span>

                <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">rank</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">iterations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_params</span><span class="p">(</span><span class="n">user_defined</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">rank</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">iterations</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">load_parameters</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">imputed_matrix</span> <span class="o">=</span> <span class="n">cdrec</span><span class="p">(</span><span class="n">contamination</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infected_matrix</span><span class="p">,</span> <span class="n">truncation_rank</span><span class="o">=</span><span class="n">rank</span><span class="p">,</span>
                                            <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">logs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logs</span><span class="p">)</span>

                <span class="k">return</span> <span class="bp">self</span></div>
</div>
</div>


<div class="viewcode-block" id="Imputation.Regression">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.Regression">[docs]</a>
    <span class="k">class</span> <span class="nc">Regression</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A class containing imputation algorithms for regression-based methods.</span>

<span class="sd">        Subclasses</span>
<span class="sd">        ----------</span>
<span class="sd">        IIM :</span>
<span class="sd">            Imputation method using Iterative Imputation with Metric learning (IIM).</span>
<span class="sd">        &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Imputation.Regression.IIM">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.Regression.IIM">[docs]</a>
        <span class="k">class</span> <span class="nc">IIM</span><span class="p">(</span><span class="n">BaseImputer</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            IIM class to impute missing values using Iterative Imputation with Metric Learning (IIM).</span>

<span class="sd">            Methods</span>
<span class="sd">            -------</span>
<span class="sd">            impute(self, user_defined=True, params=None):</span>
<span class="sd">                Perform imputation using the IIM algorithm.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">algorithm</span> <span class="o">=</span> <span class="s2">&quot;iim&quot;</span>

<div class="viewcode-block" id="Imputation.Regression.IIM.impute">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.Regression.IIM.impute">[docs]</a>
            <span class="k">def</span> <span class="nf">impute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_defined</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Perform imputation using the IIM algorithm.</span>

<span class="sd">                Parameters</span>
<span class="sd">                ----------</span>
<span class="sd">                user_defined : bool, optional</span>
<span class="sd">                    Whether to use user-defined or default parameters (default is True).</span>
<span class="sd">                params : dict, optional</span>
<span class="sd">                    Parameters of the IIM algorithm, if None, default ones are loaded.</span>

<span class="sd">                    - learning_neighbours : int</span>
<span class="sd">                        Number of nearest neighbors for learning.</span>
<span class="sd">                    - algo_code : str</span>
<span class="sd">                        Unique code for the algorithm configuration.</span>

<span class="sd">                Returns</span>
<span class="sd">                -------</span>
<span class="sd">                self : IIM</span>
<span class="sd">                    The object with `imputed_matrix` set.</span>

<span class="sd">                Example</span>
<span class="sd">                -------</span>
<span class="sd">                &gt;&gt;&gt; iim_imputer = Imputation.Regression.IIM(infected_matrix)</span>
<span class="sd">                &gt;&gt;&gt; iim_imputer.impute()  # default parameters for imputation &gt; or</span>
<span class="sd">                &gt;&gt;&gt; iim_imputer.impute(user_defined=True, params={&#39;learning_neighbors&#39;: 10})  # user-defined  &gt; or</span>
<span class="sd">                &gt;&gt;&gt; iim_imputer.impute(user_defined=False, params={&quot;ground_truth&quot;: ts_1.data, &quot;optimizer&quot;: &quot;bayesian&quot;, &quot;options&quot;: {&quot;n_calls&quot;: 2}})  # auto-ml with bayesian</span>
<span class="sd">                &gt;&gt;&gt; imputed_data = iim_imputer.imputed_matrix</span>

<span class="sd">                References</span>
<span class="sd">                ----------</span>
<span class="sd">                A. Zhang, S. Song, Y. Sun and J. Wang, &quot;Learning Individual Models for Imputation,&quot; 2019 IEEE 35th International Conference on Data Engineering (ICDE), Macao, China, 2019, pp. 160-171, doi: 10.1109/ICDE.2019.00023.</span>
<span class="sd">                keywords: {Data models;Adaptation models;Computational modeling;Predictive models;Numerical models;Aggregates;Regression tree analysis;Missing values;Data imputation}</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">learning_neighbours</span><span class="p">,</span> <span class="n">algo_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_params</span><span class="p">(</span><span class="n">user_defined</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">learning_neighbours</span><span class="p">,</span> <span class="n">algo_code</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">load_parameters</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">imputed_matrix</span> <span class="o">=</span> <span class="n">iim</span><span class="p">(</span><span class="n">contamination</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infected_matrix</span><span class="p">,</span> <span class="n">number_neighbor</span><span class="o">=</span><span class="n">learning_neighbours</span><span class="p">,</span>
                                          <span class="n">algo_code</span><span class="o">=</span><span class="n">algo_code</span><span class="p">,</span> <span class="n">logs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logs</span><span class="p">)</span>

                <span class="k">return</span> <span class="bp">self</span></div>
</div>
</div>


<div class="viewcode-block" id="Imputation.ML">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.ML">[docs]</a>
    <span class="k">class</span> <span class="nc">ML</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A class containing imputation algorithms for machine learning-based methods.</span>

<span class="sd">        Subclasses</span>
<span class="sd">        ----------</span>
<span class="sd">        MRNN :</span>
<span class="sd">            Imputation method using Multi-directional Recurrent Neural Networks (MRNN).</span>
<span class="sd">        &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Imputation.ML.MRNN">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.ML.MRNN">[docs]</a>
        <span class="k">class</span> <span class="nc">MRNN</span><span class="p">(</span><span class="n">BaseImputer</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            MRNN class to impute missing values using Multi-directional Recurrent Neural Networks (MRNN).</span>

<span class="sd">            Methods</span>
<span class="sd">            -------</span>
<span class="sd">            impute(self, user_defined=True, params=None):</span>
<span class="sd">                Perform imputation using the MRNN algorithm.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">algorithm</span> <span class="o">=</span> <span class="s2">&quot;mrnn&quot;</span>

<div class="viewcode-block" id="Imputation.ML.MRNN.impute">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.ML.MRNN.impute">[docs]</a>
            <span class="k">def</span> <span class="nf">impute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_defined</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Perform imputation using the MRNN algorithm.</span>

<span class="sd">                Parameters</span>
<span class="sd">                ----------</span>
<span class="sd">                user_defined : bool, optional</span>
<span class="sd">                    Whether to use user-defined or default parameters (default is True).</span>
<span class="sd">                params : dict, optional</span>
<span class="sd">                    Parameters of the MRNN algorithm, if None, default ones are loaded.</span>

<span class="sd">                    - hidden_dim : int</span>
<span class="sd">                        The number of hidden units in the neural network.</span>
<span class="sd">                    - learning_rate : float</span>
<span class="sd">                        Learning rate for training the neural network.</span>
<span class="sd">                    - iterations : int</span>
<span class="sd">                        Number of iterations for training.</span>
<span class="sd">                    - sequence_length : int</span>
<span class="sd">                        The length of the sequences used in the recurrent neural network.</span>

<span class="sd">                Returns</span>
<span class="sd">                -------</span>
<span class="sd">                self : MRNN</span>
<span class="sd">                    The object with `imputed_matrix` set.</span>

<span class="sd">                Example</span>
<span class="sd">                -------</span>
<span class="sd">                &gt;&gt;&gt; mrnn_imputer = Imputation.ML.MRNN(infected_matrix)</span>
<span class="sd">                &gt;&gt;&gt; mrnn_imputer.impute()  # default parameters for imputation &gt; or</span>
<span class="sd">                &gt;&gt;&gt; mrnn_imputer.impute(user_defined=True, params={&#39;hidden_dim&#39;: 10, &#39;learning_rate&#39;:0.01, &#39;iterations&#39;:50, &#39;sequence_length&#39;: 7})  # user-defined &gt; or</span>
<span class="sd">                &gt;&gt;&gt; mrnn_imputer.impute(user_defined=False, params={&quot;ground_truth&quot;: ts_1.data, &quot;optimizer&quot;: &quot;bayesian&quot;, &quot;options&quot;: {&quot;n_calls&quot;: 2}})  # auto-ml with bayesian</span>
<span class="sd">                &gt;&gt;&gt; imputed_data = mrnn_imputer.imputed_matrix</span>

<span class="sd">                References</span>
<span class="sd">                ----------</span>
<span class="sd">                J. Yoon, W. R. Zame and M. van der Schaar, &quot;Estimating Missing Data in Temporal Data Streams Using Multi-Directional Recurrent Neural Networks,&quot; in IEEE Transactions on Biomedical Engineering, vol. 66, no. 5, pp. 1477-1490, May 2019, doi: 10.1109/TBME.2018.2874712. keywords: {Time measurement;Interpolation;Estimation;Medical diagnostic imaging;Correlation;Recurrent neural networks;Biomedical measurement;Missing data;temporal data streams;imputation;recurrent neural nets}</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="n">sequence_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_params</span><span class="p">(</span><span class="n">user_defined</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="n">sequence_length</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">load_parameters</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span>
                                                                                                   <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;mrnn&quot;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">imputed_matrix</span> <span class="o">=</span> <span class="n">mrnn</span><span class="p">(</span><span class="n">contamination</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infected_matrix</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="o">=</span><span class="n">hidden_dim</span><span class="p">,</span>
                                           <span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">,</span>
                                           <span class="n">sequence_length</span><span class="o">=</span><span class="n">sequence_length</span><span class="p">,</span> <span class="n">logs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logs</span><span class="p">)</span>

                <span class="k">return</span> <span class="bp">self</span></div>
</div>
</div>


<div class="viewcode-block" id="Imputation.Pattern">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.Pattern">[docs]</a>
    <span class="k">class</span> <span class="nc">Pattern</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A class containing imputation algorithms for pattern-based methods.</span>

<span class="sd">        Subclasses</span>
<span class="sd">        ----------</span>
<span class="sd">        STMVL :</span>
<span class="sd">            Imputation method using Spatio-Temporal Matrix Variational Learning (STMVL).</span>
<span class="sd">        &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Imputation.Pattern.STMVL">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.Pattern.STMVL">[docs]</a>
        <span class="k">class</span> <span class="nc">STMVL</span><span class="p">(</span><span class="n">BaseImputer</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            STMVL class to impute missing values using Spatio-Temporal Matrix Variational Learning (STMVL).</span>

<span class="sd">            Methods</span>
<span class="sd">            -------</span>
<span class="sd">            impute(self, user_defined=True, params=None):</span>
<span class="sd">                Perform imputation using the STMVL algorithm.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">algorithm</span> <span class="o">=</span> <span class="s2">&quot;stmvl&quot;</span>

<div class="viewcode-block" id="Imputation.Pattern.STMVL.impute">
<a class="viewcode-back" href="../../../imputegap.imputation.html#imputegap.recovery.imputation.Imputation.Pattern.STMVL.impute">[docs]</a>
            <span class="k">def</span> <span class="nf">impute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_defined</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Perform imputation using the STMVL algorithm.</span>

<span class="sd">                Parameters</span>
<span class="sd">                ----------</span>
<span class="sd">                user_defined : bool, optional</span>
<span class="sd">                    Whether to use user-defined or default parameters (default is True).</span>
<span class="sd">                params : dict, optional</span>
<span class="sd">                    Parameters of the STMVL algorithm, if None, default ones are loaded.</span>

<span class="sd">                    - window_size : int</span>
<span class="sd">                        The size of the temporal window for imputation.</span>
<span class="sd">                    - gamma : float</span>
<span class="sd">                        Smoothing parameter for temporal weights.</span>
<span class="sd">                    - alpha : float</span>
<span class="sd">                        Power for spatial weights.</span>

<span class="sd">                Returns</span>
<span class="sd">                -------</span>
<span class="sd">                self : STMVL</span>
<span class="sd">                    The object with `imputed_matrix` set.</span>

<span class="sd">                Example</span>
<span class="sd">                -------</span>
<span class="sd">                &gt;&gt;&gt; stmvl_imputer = Imputation.Pattern.STMVL(infected_matrix)</span>
<span class="sd">                &gt;&gt;&gt; stmvl_imputer.impute()  # default parameters for imputation &gt; or</span>
<span class="sd">                &gt;&gt;&gt; stmvl_imputer.impute(user_defined=True, params={&#39;window_size&#39;: 7, &#39;learning_rate&#39;:0.01, &#39;gamma&#39;:0.85, &#39;alpha&#39;: 7})  # user-defined  &gt; or</span>
<span class="sd">                &gt;&gt;&gt; stmvl_imputer.impute(user_defined=False, params={&quot;ground_truth&quot;: ts_1.data, &quot;optimizer&quot;: &quot;bayesian&quot;, &quot;options&quot;: {&quot;n_calls&quot;: 2}})  # auto-ml with bayesian</span>
<span class="sd">                &gt;&gt;&gt; imputed_data = stmvl_imputer.imputed_matrix</span>

<span class="sd">                References</span>
<span class="sd">                ----------</span>
<span class="sd">                Yi, X., Zheng, Y., Zhang, J., &amp; Li, T. ST-MVL: Filling Missing Values in Geo-Sensory Time Series Data.</span>
<span class="sd">                School of Information Science and Technology, Southwest Jiaotong University; Microsoft Research; Shenzhen Institutes of Advanced Technology, Chinese Academy of Sciences.</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">window_size</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_params</span><span class="p">(</span><span class="n">user_defined</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">window_size</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">load_parameters</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;stmvl&quot;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">imputed_matrix</span> <span class="o">=</span> <span class="n">stmvl</span><span class="p">(</span><span class="n">contamination</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">infected_matrix</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="n">window_size</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span>
                                            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">logs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logs</span><span class="p">)</span>

                <span class="k">return</span> <span class="bp">self</span></div>
</div>
</div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Quentin Nater.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>